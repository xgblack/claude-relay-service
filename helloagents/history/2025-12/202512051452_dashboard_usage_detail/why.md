# 变更提案: 仪表板调用明细区块

## 需求背景
当前仪表板仅展示按天的用量趋势，缺少与截图示例类似的“调用记录明细”表格，无法在同一页快速定位单次请求的模型、Token 与费用，影响运维排查与成本分析效率。

## 产品分析

### 目标用户与场景
- **运维/管理员**：需要在仪表板快速查找异常请求、核对费用。
- **财务/成本分析**：需要按时间段回溯调用费用与模型分布。

### 价值主张与成功指标
- **价值主张**：在仪表板底部直接查看调用明细，减少页面跳转。
- **成功指标**：
  - 用户可在 3 步内筛到指定时间段和模型的调用记录。
  - 单页加载 20 条明细，分页切换无显著卡顿（<1s 渲染）。

### 人文关怀
- 默认隐藏敏感字段（如账户邮箱），仅展示必要标识。

## 变更内容
1. 后端新增/扩展调用明细查询接口，支持全量或按条件筛选（时间、模型、账户、API Key）。
2. 前端仪表板页面底部新增“调用明细”区块，支持分页、列展示全部可用字段，后续可按需隐藏。
3. 保持与现有时间选择器联动，默认每页 20 条，可选 20/50/100。

## 影响范围
- **模块:** admin-web 仪表板、admin 后端 usageStats 路由、Redis 用量数据读取。
- **文件:** `src/routes/admin/usageStats.js`, `web/admin-spa` 仪表板相关组件/服务。
- **API:** 新增/扩展调用明细接口。
- **数据:** 读取 `usage:records:<keyId>` 列表及相关聚合键。

## 核心场景

### 需求: 仪表板调用明细
**模块:** admin-web
在仪表板中查看选定时间范围内的调用明细列表。

#### 场景: 默认查看
- 条件：进入仪表板，未调整筛选
- 预期结果：显示最近时间范围的明细（按时间倒序），每页20条，可翻页。

#### 场景: 条件筛选
- 条件：用户选择时间范围/模型/账户/API Key
- 预期结果：列表按条件过滤，分页与汇总同步更新。

## 风险评估
- **风险:** 全量扫描所有 key 的明细可能带来性能问题。
- **缓解:** 查询接口限定最大记录数与时间范围，并分页；必要时先按 key 聚合再合并排序。
